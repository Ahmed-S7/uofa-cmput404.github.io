<!DOCTYPE html>
<html lang="en">
<head>
          <title>CMPUT 404 - Django Lab</title>
        <meta charset="utf-8" />
        <meta name="generator" content="Pelican" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="Web Applications and Architecture" />

  <link rel="icon" href="../theme/favicon.ico" />
  <link rel="stylesheet" type="text/css" href="../theme/style.css" />
  <link rel="stylesheet" type="text/css" href="../theme/404.css" />




    <meta name="tags" content="labs" />

</head>

<body>
        <header>
              <hgroup><h1><a href="../">CMPUT 404</a></h1><p>Web Applications and Architecture</p></hgroup>
        <nav><ul>
            <li><a href="/general/outline.html">Outline</a></li>
            <li><a href="https://eclass.srv.ualberta.ca/course/view.php?id=95227">eClass</a></li>
            <li><a href="/general/schedule.html">Schedule</a></li>
            <li><a href="/general/labs.html">Labs</a></li>
            <li><a href="/general/project.html">Project</a></li>
            <li><a href="/general/resources.html">Resources</a></li>
            <li><a href="/general/help.html">Help</a></li>
        </ul></nav>
        </header>
        <main>
<article>
  <header>
    <h2>
      <a href="../labsignments/django.html" rel="bookmark"
         title="Permalink to Django Lab">Django Lab</a></h2>
 
  </header>
  <div class="toc">
<ul>
<li><a href="#description">Description</a></li>
<li><a href="#getting-started">Getting Started</a><ul>
<li><a href="#prepare-your-repo">Prepare your Repo</a></li>
<li><a href="#create-the-virtual-environment">Create the Virtual Environment</a><ul>
<li><a href="#if-you-have-multiple-versions-of-python-installed">If you have multiple versions of python installed:</a></li>
<li><a href="#check-if-you-have-pip">Check if you have pip</a></li>
<li><a href="#check-if-you-have-venv-or-virtualenv">Check if you have venv or virtualenv</a></li>
<li><a href="#if-youre-on-ubuntu-or-debian-and-dont-have-venv-or-virtualenv">If you're on Ubuntu or Debian and don't have venv or virtualenv:</a></li>
<li><a href="#if-you-have-pip-installed-but-not-venv">If you have pip installed but not venv:</a></li>
<li><a href="#create-a-virtual-environment">Create a Virtual Environment</a></li>
</ul>
</li>
<li><a href="#activate-virtual-environment">Activate Virtual Environment</a></li>
<li><a href="#installing-node-js-and-npm">Installing node JS and npm</a></li>
</ul>
</li>
<li><a href="#lab-instructions">Lab Instructions</a><ul>
<li><a href="#phase-two-automation">Phase Two: Automation</a></li>
</ul>
</li>
<li><a href="#restrictions">Restrictions</a></li>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#submission-instructions">Submission Instructions</a></li>
<li><a href="#collaboration">Collaboration</a></li>
<li><a href="#tips">Tips</a></li>
</ul>
</div>
<h3 id="description">Description</h3>
<p>The purpose of this lab is to familiarize you with setting up a virtual environment, developing in django and using npm.
By the end of this lab you will make a simple emoji picker app.</p>
<h3 id="getting-started">Getting Started</h3>
<h4 id="prepare-your-repo">Prepare your Repo</h4>
<ol>
<li>Get the github classroom link from eClass, create your assignment, and clone it.</li>
<li>Create an appropriate <code>.gitignore</code> file, to prevent unwanted files being commited to your repository.</li>
</ol>
<p>Place this gitignore within the root of your project. You can combine <a href="https://github.com/github/gitignore/blob/main/Python.gitignore">this one</a> and <a href="https://github.com/github/gitignore/blob/main/Node.gitignore">this one</a> and <a href="https://github.com/django/django/blob/main/.gitignore">this one</a> for your django+node project. Double check you're not staging any unwanted files before you commit. The <code>git status</code> command can help with that.</p>
<h4 id="create-the-virtual-environment">Create the Virtual Environment</h4>
<p>Virtual environment is a CLI tool for managing python dependencies. Different projects have different dependencies, and version requirements. A virtual environment allows you to manage your dependencies specific to your project.</p>
<h5 id="if-you-have-multiple-versions-of-python-installed">If you have multiple versions of python installed:</h5>
<p>Always end the python command with the version number. </p>
<p>For example, on the undergrad machines ugXX.cs.ualberta.ca: you can use <code>python3.11</code>.</p>
<h5 id="check-if-you-have-pip">Check if you have pip</h5>
<p><code>python3.XX -m pip</code> should give information about how to use pip.</p>
<p>For example, on the undergrad machines ugXX.cs.ualberta.ca: you can use <code>python3.11 -m pip</code>.</p>
<h5 id="check-if-you-have-venv-or-virtualenv">Check if you have venv or virtualenv</h5>
<p><code>python3.XX -m venv --help</code> should give information about how to use venv.</p>
<p>If you don't have <code>venv</code>, try <code>virtualenv</code>: <code>python -m virtualenv --help</code> should give information about how to use virtualenv.</p>
<p>For example, on the undergrad machines ugXX.cs.ualberta.ca: you can use <code>python3.11 -m venv --help</code>.</p>
<h5 id="if-youre-on-ubuntu-or-debian-and-dont-have-venv-or-virtualenv">If you're on Ubuntu or Debian and don't have venv or virtualenv:</h5>
<p>`</p>
<h5 id="if-you-have-pip-installed-but-not-venv">If you have pip installed but not venv:</h5>
<ol>
<li><code>python -m pip install --user virtualenv</code></li>
<li>Check installation: <code>python -m virtualenv --help</code> </li>
</ol>
<p>For more info check <a href="https://virtualenv.pypa.io/en/latest/installation.html">here</a>.</p>
<h5 id="create-a-virtual-environment">Create a Virtual Environment</h5>
<h4 id="activate-virtual-environment">Activate Virtual Environment</h4>
<p>To use a virtual environment:</p>
<ol>
<li><code>source venv/bin/activate</code></li>
</ol>
<p>The first command will create a directory named <code>venv</code>. Contained in the directory is your
project dependecy installation and the <code>activate</code> script. Run <code>deactivate</code> to exit the virtual environment.</p>
<h4 id="installing-node-js-and-npm">Installing node JS and npm</h4>
<p>To install node js, you can download the appropriate installer directly from the node js
<a href="https://nodejs.org/en/download">website</a>. Make sure to download the LTS version. The installation 
will include npm as well.</p>
<h3 id="lab-instructions">Lab Instructions</h3>
<p>The framework we will be using for this lab is <a href="https://www.djangoproject.com/">django</a>, a high-level python web framework. Django is a well documented framework, with a large developer community. The official django <a href="https://docs.djangoproject.com/en/5.0/">documentation</a> is also an ideal place to learn more and look up specific features.</p>
<p>Get started by creating a virtual environment and installing django: </p>
<ol>
<li>Within your assignment directory create a virtual environment: <code>virtualenv venv --python=python3</code></li>
<li>Activate the virtual environment: <code>source venv/bin/activate</code></li>
<li>Add the line <code>Django&gt;=5.0.1</code> to a new file, <code>requirements.txt</code>, at the top level of your repo.</li>
<li>Install django: <code>python -m pip install -r requirements.txt</code></li>
<li>Verify installation by running a python shell and using: <code>import django</code></li>
</ol>
<p>To create a django project:</p>
<ol>
<li>Run <code>django-admin startproject lab2</code></li>
<li>Verify "lab2" directory containing project files is created</li>
<li>move into directory: <code>cd lab2</code></li>
<li>Run <code>python manage.py runserver 0.0.0.0:8000</code></li>
<li>In your browser access <code>localhost:8000</code></li>
</ol>
<p>If all went well you should see a "Congratulations!" with a rocket flying off.</p>
<p>In this lab we will be using an emoji picker package to display emojis on a django webpage. We will create a webapp called "emojis" using django. To create a new webapp inside your django project run <code>python manage.py startapp emojis</code>. This will create an <code>emojis</code> directory in your folder. Locate <code>emojis/views.py</code> and add the following code:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span> <span class="c1"># Make sure to include this import</span>


<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s2">&quot;This is the emoji app.&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Create a <code>urls.py</code> within the <code>emojis</code> directory, and add the following code:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span> <span class="c1"># . referes to the current module we are in</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">),</span>
<span class="p">]</span>
</code></pre></div>

<p>Ensure your <code>lab2/urls.py</code> looks like this:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">path</span> <span class="c1"># make sure you have &quot;include&quot;</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s2">&quot;emojis/&quot;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s2">&quot;emojis.urls&quot;</span><span class="p">)),</span>
    <span class="n">path</span><span class="p">(</span><span class="s2">&quot;admin/&quot;</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
<span class="p">]</span>
</code></pre></div>

<p>Make sure to register your app with the project by modifying <code>lab2/settings.py</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;emojis.apps.EmojisConfig&#39;</span><span class="p">,</span> <span class="c1"># don&#39;t forget to add this line !!</span>
    <span class="s1">&#39;django.contrib.admin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.auth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.contenttypes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.sessions&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.messages&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.staticfiles&#39;</span><span class="p">,</span>
<span class="p">]</span>
</code></pre></div>

<p>Access the emojis app using: <code>localhost:8000/emojis</code> from your browser.</p>
<p>Now it's pretty boring receiving a plain text response. Let's try rendering an html page. One way to achieve this using django is with <code>templates</code>:</p>
<ol>
<li>Create <code>templates</code> directory inside <code>emojis</code>. Django will look for this directory by default.</li>
<li>Inside templates create a file called <code>index.html</code>.</li>
</ol>
<p>Place the following html boilerplate inside <code>index.html</code>:</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Emojis App<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Welcome to Emojis!<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>

<p>Go back to <code>emojis/views.py</code> and make sure to render this html template:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span> <span class="c1"># Import this shortcut function</span>

<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;index.html&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Now you should get a big welcome message when you access <code>localhost:8000/emojis</code>.</p>
<p>Npm is a package manager for node JS. Node JS is a runtime environment for JavaScript. The node JS developer community use npm to distribute useful packages. For this lab we will be using <a href="https://www.npmjs.com/package/emoji-mart">emoji-mart</a> to create a fun browser based emoji picker. Ensure you have npm and node installed (<a href="/labsignments/django.html#installing-node-js-and-npm">Refer to Getting Started</a>)</p>
<p>To use the package we need to install the JavaScript module using npm:</p>
<ol>
<li>Run <code>npm install --save-dev emoji-mart</code> in your project root where <code>manage.py</code> is.</li>
<li>This should create a new directory called <code>node_modules</code></li>
<li>Locate <code>node_modules/emoji-mart</code> to verify installation</li>
<li>Create a directory called <code>static</code> inside <code>emojis</code>, where you made the <code>templates</code> directory</li>
<li>Create a file called <code>main.js</code> where <code>node_modules</code> is located (but not inside <code>node_modules</code>)</li>
</ol>
<p>Within <code>main.js</code> add the following code:</p>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">Picker</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;emoji-mart&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// import Picker class from module</span>
<span class="c1">// This is where you would import other modules you installed with npm too, but for this example we only have the emoji-mart.</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">pickerOptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">onEmojiSelect</span><span class="o">:</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="w"> </span><span class="p">}</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">picker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Picker</span><span class="p">(</span><span class="nx">pickerOptions</span><span class="p">)</span><span class="w"> </span><span class="c1">// instantiate object</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">picker</span><span class="p">)</span><span class="w"> </span><span class="c1">// add to DOM</span>
</code></pre></div>

<p>Now this file won't be able do much here, but it will be useful within a browser environment. To make <code>main.js</code> run in a browser, it must be in a compatible format. Fortunately, there are tools such as webpack, vite, and esbuild that can build or transpile our javascript code into a format the browser can handle. The tool we will be using for this lab is <a href="https://esbuild.github.io/getting-started/">esbuild</a>:</p>
<ol>
<li>First install esbuild using npm: <code>npm install --save-exact --save-dev esbuild</code></li>
<li>Transpile <code>main.js</code> to the static directory: <code>npx esbuild main.js --bundle --minify --sourcemap --outfile=./emojis/static/main.min.js</code></li>
<li>Verify <code>main.min.js</code> is created within <code>emojis/static</code></li>
<li>Add a line to your <code>.gitignore</code> to prevent <code>main.min.js</code> from being added to git.</li>
</ol>
<p>Now that we have our static files ready to go, modify your <code>index.html</code> to load your main.js file.</p>
<div class="highlight"><pre><span></span><code>{% load static %}
<span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Emojis App<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Welcome to Emojis!<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;{% static &#39;main.min.js&#39; %}&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>

<p>You should now be able to see the emoji picker on <code>localhost:8000/emojis</code>.</p>
<h4 id="phase-two-automation">Phase Two: Automation</h4>
<p>Double check that your git repository doesn't contain any built or reinstallable artifacts such as:</p>
<ul>
<li>The virtual environment (venv)</li>
<li>node_modules</li>
<li>main.min.js</li>
</ul>
<p>Make sure that it does contain:</p>
<ul>
<li>package.json</li>
<li>requirements.txt</li>
<li>All files you created and/or edited</li>
<li>The files that django-admin startproject created</li>
</ul>
<p>Write a python script and (and add it to your repository) that:</p>
<ol>
<li>Creates the virtualenv if it doesn't already exist</li>
<li>Activates the virtualenv if it's not already active</li>
<li>Installs everything from <code>requirements.txt</code> to virtualenv if its not already installed</li>
<li>Runs <code>npm install</code> to install every depencency from <code>package.json</code> to node_modules</li>
<li>Runs esbuild to build <code>main.min.js</code></li>
<li>Starts the django server</li>
</ol>
<p>Do not have it install python, venv, or node. We will assume that every web developer has these installed already.</p>
<p>Your goal is to have a repository by the end that is just the stuff you need for your script to
install dependencies of your project and get it started, regardless of what computer your
repository is cloned to.</p>
<p>That is you should be able to log onto a different computer with a different OS and run the python
script you wrote and it should download the pypi packages it needs with pip, download the npm packages
it needs with npm, and then runs your project.</p>
<ul>
<li>Assuming python, virtualenv, and node are already installed:<ul>
<li>your repo + your script = a fully working app</li>
<li>while keeping our repo clean of things that can just be downloaded or compiled/transpiled/etc. again</li>
</ul>
</li>
</ul>
<h3 id="restrictions">Restrictions</h3>
<p>Violation of the restrictions will result in a mark of zero.</p>
<ul>
<li>Must use Python3</li>
<li>Must run on Ubuntu (Use the undergrad lab machines, for example the ones in CSC 2-29 or install an Ubuntu VM to check this)</li>
<li>Must run on your machine (whatever machine you use to demo)</li>
</ul>
<h3 id="requirements">Requirements</h3>
<ul>
<li>A working Django 5 application<ul>
<li>using the latest Django version from pypi<ul>
<li>downloaded with pip into a virtualenv</li>
</ul>
</li>
<li>that can serve a template that uses<ul>
<li>JS code bundled by esbuild<ul>
<li>which loads a JS library<ul>
<li>that was intalled by npm</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>A git repository that does not contain built (compiled, transpiled, bundled) or downloaded artifacts, including but not limited to:<ul>
<li>virtualenv</li>
<li>node_modules</li>
<li>main.min.js</li>
</ul>
</li>
</ul>
<h3 id="submission-instructions">Submission Instructions</h3>
<p>Make sure you push to github classroom <strong>BEFORE 4PM on the day of your lab section!</strong> You will not be able to push after that!</p>
<p>Submit a link to your repo in the form <code>https://github.com/uofa-cmput404/w24-h0x-labsignment-django-yourgithubname</code> on eClass. <strong>Do not</strong> submit a link to a branch, a file, or the clone url. If you do not do this we will not know which github submission is yours.</p>
<h3 id="collaboration">Collaboration</h3>
<ul>
<li>You may consult with others (exchange high-level ideas) but the submission should be your own source code.</li>
<li>Collaboration must be documented in your source code.</li>
<li>Any source code you got from anywhere else must be cited in the source code.</li>
<li>You can only use source code that <strong>you understand</strong>: see the <a href="../general/labs.html#lab-marking">lab marking info</a></li>
</ul>
<h3 id="tips">Tips</h3>
<p>Django is a complex framework and maybe overwhelming at times. You should consult the documentation should you run into any issues with the framework. </p>
<p>If you're unable to load a static file or resource, it maybe because you're not referencing it correctly. It may be in a different directory or you have a typo when you are referencing that particular resource using its path. </p>
<p>Another common problem is not being able to render the templates even though you're directory structure is correct. Make sure your app is registered in <code>settings.py</code> otherwise it may not render.</p>
  <footer>
    <p>Published: <time datetime="2024-01-16T00:00:00-07:00">
      Tue, 16 Jan 2024 at 00:00 MST
    </time></p>
    <address>
      By           <a href="../author/alireza-azimi.html">Alireza Azimi</a>
    </address>
    <p>
        Category: <a href="../category/labsignments.html">labsignments</a>
    </p>
    <p>
        Tags:
            <a href="../tag/labs.html">labs</a>
    </p>
  </footer>
  </article>
        </main>
        <footer>
                <address>
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>,
                which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address>
        </footer>
</body>
</html>